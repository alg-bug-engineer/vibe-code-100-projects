# CogniFlow 用户系统使用指南

## 概述

CogniFlow 现在支持完整的用户登录/注册系统，每个用户的数据完全隔离，所有数据保存在本地。

## 主要特性

### 🔐 用户认证
- **用户注册**: 支持用户名、邮箱、手机号（可选）注册
- **密码登录**: 安全的密码验证机制
- **快速登录**: 兼容旧版本的快速登录方式
- **会话管理**: 自动保持登录状态

### 📁 数据隔离
- **独立存储**: 每个用户的数据完全独立
- **本地存储**: 所有数据保存在浏览器本地存储中
- **实时切换**: 支持多用户快速切换，数据不混淆

### 🔒 安全特性
- **密码哈希**: 密码经过哈希处理存储
- **数据加密**: 用户数据安全存储
- **会话保护**: 安全的用户会话管理

## 使用方法

### 1. 用户注册

访问登录页面 (`/login`)，切换到"注册"标签页：

1. **填写用户信息**:
   - 用户名：3-20个字符，支持中文、字母、数字、下划线
   - 邮箱：有效的邮箱地址
   - 手机号：可选，11位手机号
   - 密码：至少6位，需包含字母和数字

2. **密码安全要求**:
   - 最少6个字符
   - 包含字母和数字
   - 系统会实时显示密码强度

3. **提交注册**: 点击"注册"按钮完成账户创建

### 2. 用户登录

#### 密码登录（推荐）
1. 在登录页面选择"密码登录"标签
2. 输入用户名或邮箱
3. 输入密码
4. 点击"登录"

#### 快速登录（兼容模式）
1. 在登录页面选择"快速登录"标签
2. 可选择输入手机号或邮箱
3. 或直接点击"快速登录（使用默认用户）"

### 3. 数据管理

登录后，您的所有操作都会保存到个人数据文件中：

- **条目管理**: 创建、编辑、删除的所有条目
- **标签系统**: 个人标签统计和管理
- **用户设置**: 个人偏好设置
- **数据隔离**: 其他用户无法访问您的数据

### 4. 多用户支持

- **用户切换**: 可以注册多个账户并随时切换
- **数据独立**: 每个用户的数据完全独立存储
- **快速识别**: 系统会显示当前登录用户信息

## 测试功能

### 访问测试页面
访问 `/test` 路径可以进入测试页面，该页面提供：

1. **当前用户状态**: 显示登录状态和用户信息
2. **系统统计**: 显示用户数量、数据统计等
3. **自动化测试**: 一键测试所有功能
4. **手动测试工具**: 清空数据、刷新状态等

### 运行自动化测试
1. 访问 `/test` 页面
2. 点击"运行完整测试"按钮
3. 系统会自动：
   - 创建两个测试用户
   - 为每个用户创建不同的数据
   - 验证数据隔离功能
   - 显示测试结果

## 数据存储说明

### 存储位置
所有数据存储在浏览器的 localStorage 中：

- **用户列表**: `cogniflow_users.json`
- **用户数据**: `cogniflow_user_{用户ID}`
- **当前用户**: `cogniflow_current_user`

### 数据结构
每个用户的数据包含：
- `items`: 用户的所有条目
- `profile`: 用户信息
- `settings`: 个人设置
- `lastModified`: 最后修改时间

### 数据导出/导入
系统支持数据的导出和导入功能（开发中），可以：
- 导出个人数据用于备份
- 导入数据到新设备
- 在不同浏览器间迁移数据

## 注意事项

### 数据安全
- 数据仅存储在本地浏览器中
- 清除浏览器数据会丢失所有信息
- 建议定期备份重要数据
- 密码采用基础哈希，适合个人使用

### 浏览器兼容性
- 需要支持 localStorage 的现代浏览器
- 建议使用 Chrome、Firefox、Safari、Edge 等主流浏览器

### 性能考虑
- 本地存储适合中小型数据量
- 大量数据可能影响性能
- 建议定期清理不需要的历史数据

## 故障排除

### 登录问题
- 确认用户名和密码正确
- 检查是否已完成注册
- 尝试清除浏览器缓存

### 数据丢失
- 检查是否在同一浏览器和域名
- 确认没有清除浏览器存储
- 查看浏览器开发者工具的 localStorage

### 功能异常
- 访问 `/test` 页面进行系统诊断
- 运行自动化测试验证功能
- 查看浏览器控制台的错误信息

## 开发者信息

### 技术架构
- **前端**: React + TypeScript + Vite
- **状态管理**: React Hooks + Context
- **存储**: localStorage + 自定义存储管理器
- **认证**: 本地认证系统
- **路由**: React Router

### API 接口
- `localAuth`: 用户认证管理
- `userItemApi`: 条目数据管理
- `userProfileApi`: 用户信息管理
- `userSettingsApi`: 用户设置管理
- `LocalStorageManager`: 底层存储管理

### 扩展开发
系统设计为模块化架构，可以轻松扩展：
- 添加新的数据类型
- 集成云端同步
- 添加更多认证方式
- 增强安全特性