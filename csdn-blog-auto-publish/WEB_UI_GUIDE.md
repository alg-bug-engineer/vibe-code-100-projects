# Web界面使用指南

## 🌐 启动界面

### 方式1：使用启动脚本（推荐）

```bash
./start.sh
# 选择选项 1: 启动Web界面
```

### 方式2：直接启动

```bash
# 确保已安装依赖
pip install gradio>=4.0.0

# 启动界面
python ui.py
```

界面将自动在浏览器中打开，默认地址：`http://localhost:7860`

---

## 📱 界面功能说明

### Tab 1: ⚙️ 系统配置

**功能**：配置和初始化系统

#### 操作步骤：
1. 输入智谱AI的API Key
2. 点击"保存并初始化"按钮
3. 等待初始化完成

#### 注意事项：
- API Key可以从智谱AI开放平台获取
- 初始化后会自动连接智谱AI服务
- 页面顶部的"系统状态"会显示当前配置情况

---

### Tab 2: 🔍 新闻搜索

**功能**：自动搜索技术新闻

#### 参数说明：
- **搜索天数**：搜索最近几天的新闻（1-7天）
- **自定义主题**：指定搜索的技术领域（可选）
  - 留空：使用默认15个主题（大模型、人工智能、智能体等）
  - 自定义：用逗号分隔，例如：`大模型,AGI,多模态AI`
- **提取新闻数量**：从搜索结果中提取多少条新闻（5-30条）

#### 操作步骤：
1. 设置搜索参数
2. 点击"开始搜索"
3. 等待搜索完成，查看结果

#### 输出：
- 搜索到的新闻列表（按主题分类）
- 新闻数据保存到 `todo/YYYYMMDD_news.json`

---

### Tab 3: 📝 标题生成

**功能**：基于搜索的新闻生成优化的博客标题

#### 前置条件：
- 必须先完成"新闻搜索"

#### 参数说明：
- **生成标题数量**：生成多少个博客标题（5-30个）

#### 操作步骤：
1. 设置生成数量
2. 点击"生成标题"
3. 等待生成完成
4. 在下方的下拉框中可以选择特定标题（用于后续生成文章）

#### 输出：
- 优化后的标题列表
- 标题数据保存到 `todo/YYYYMMDD_titles.txt` 和 `todo/YYYYMMDD_titles_info.json`

#### 标题选择（可选）：
- 可以在生成的标题中选择特定的几个
- 后续生成文章时，只会为选中的标题生成文章
- 不选择则按顺序生成

---

### Tab 4: ✍️ 文章生成

**功能**：基于标题和新闻背景生成技术博客文章

#### 前置条件：
- 必须先完成"标题生成"

#### 参数说明：
- **生成文章数量**：生成多少篇文章（1-20篇）

#### 操作步骤：
1. 设置生成数量
2. 点击"开始生成"
3. 等待生成完成（可能需要几分钟）

#### 生成逻辑：
- **如果在Tab 3中选择了特定标题**：只为选中的标题生成文章
- **如果没有选择**：按顺序从标题库中生成

#### 输出：
- 文章保存到 `posts/` 目录
- 每篇文章都是独立的 `.md` 文件
- 文章包含完整的Markdown格式

#### 限制：
- posts目录最多存放16篇文章
- 如果已满，需要先发布或删除文章

---

### Tab 5: 📚 文章管理

**功能**：管理待发布的文章

#### 功能列表：

1. **刷新列表**
   - 点击"刷新列表"更新文章列表
   - 在生成新文章后使用

2. **预览文章**
   - 在下拉框中选择文章
   - 点击"预览"查看文章内容
   - 右侧会显示完整的Markdown内容

3. **删除文章**
   - 选择要删除的文章
   - 点击"删除"按钮
   - 用于清理不需要的文章

#### 使用场景：
- 生成文章后，先预览检查质量
- 删除不满意的文章
- 清理已发布的文章（发布后会自动删除）

---

### Tab 6: 🚀 CSDN发布

**功能**：批量发布文章到CSDN

#### 参数说明：
- **发布数量**：一次发布多少篇文章（1-16篇）
- **无头模式**：
  - 不勾选：浏览器可见（推荐首次使用）
  - 勾选：浏览器后台运行

#### 操作步骤：
1. 设置发布数量
2. 选择是否使用无头模式
3. 点击"开始发布"
4. **首次使用**：在弹出的浏览器中登录CSDN
5. 等待发布完成

#### 注意事项：
- **首次发布必须登录**：系统会打开CSDN登录页面，扫码登录
- **登录状态保存**：登录一次后，下次无需重复登录
- **建议首次不使用无头模式**：方便观察登录过程
- **发布时间**：每篇文章约需1-2分钟

#### 发布流程：
1. 自动打开CSDN写文章页面
2. 读取posts目录的文章
3. 自动填充标题和内容
4. 添加标签（默认"人工智能"）
5. 点击发布按钮
6. 发布成功后删除已发布的文章
7. 继续发布下一篇

#### 输出：
- 成功发布的文章列表
- 失败的文章及错误信息

---

### Tab 7: ⚡ 一键流程

**功能**：完整的自动化流程，从搜索到生成一气呵成

#### 参数说明：
- **搜索天数**：搜索最近几天的新闻
- **自定义主题**：指定技术领域（可选）
- **生成文章数量**：最终生成多少篇文章

#### 流程说明：
这个功能会自动执行以下步骤：
1. 搜索技术新闻
2. 提取关键信息
3. 生成优化的标题
4. 生成文章并保存到posts目录

#### 操作步骤：
1. 设置参数
2. 点击"一键运行"
3. 等待流程完成（可能需要10-15分钟）
4. 完成后前往"CSDN发布"标签页发布文章

#### 适用场景：
- 快速批量生成内容
- 自动化日常更新
- 省时省力的完整流程

---

## 🎯 使用建议

### 推荐工作流1：首次使用

1. **配置系统**（Tab 1）
   - 输入API Key
   - 点击初始化

2. **搜索新闻**（Tab 2）
   - 搜索天数：1天
   - 留空使用默认主题
   - 提取15条新闻

3. **生成标题**（Tab 3）
   - 生成15个标题
   - 查看标题质量

4. **生成文章**（Tab 4）
   - 先生成3-5篇测试
   - 在Tab 5中预览检查

5. **发布文章**（Tab 6）
   - 不勾选无头模式
   - 发布1-2篇测试
   - 完成首次登录

### 推荐工作流2：日常使用

1. **一键流程**（Tab 7）
   - 设置生成10篇文章
   - 等待自动完成

2. **文章管理**（Tab 5）
   - 预览生成的文章
   - 删除不满意的

3. **批量发布**（Tab 6）
   - 勾选无头模式
   - 发布所有文章

### 推荐工作流3：精细控制

1. **搜索新闻**（Tab 2）
   - 自定义主题："大模型,AGI,多模态AI"
   - 搜索最近3天

2. **生成标题**（Tab 3）
   - 生成20个标题
   - 在下拉框中选择最好的10个

3. **生成文章**（Tab 4）
   - 只为选中的10个标题生成文章

4. **人工审核**（Tab 5）
   - 逐个预览文章
   - 必要时修改（手动编辑md文件）

5. **分批发布**（Tab 6）
   - 每天发布3-5篇
   - 保持稳定更新

---

## 💡 常见问题

### Q1: 界面无法打开？
**A**: 检查以下几点：
- 是否已安装gradio：`pip install gradio>=4.0.0`
- 端口7860是否被占用
- 防火墙是否允许访问

### Q2: API Key设置后无效？
**A**: 
- 点击"保存并初始化"按钮
- 检查API Key是否正确
- 查看终端输出的错误信息

### Q3: 新闻搜索失败？
**A**: 
- 确认API Key已正确配置
- 检查网络连接
- 查看终端输出的详细错误

### Q4: 文章生成很慢？
**A**: 这是正常的
- 每篇文章需要调用AI模型，需要30-60秒
- 建议从少量开始，逐步增加
- 可以在终端查看实时进度

### Q5: CSDN登录失败？
**A**: 
- 首次使用不要勾选"无头模式"
- 确保已安装Playwright浏览器：`python -m playwright install`
- 手动在浏览器中完成登录
- 登录成功后会自动保存状态

### Q6: posts目录已满？
**A**: 
- posts目录限制16篇文章（防止过多）
- 方案1：发布现有文章（发布后自动删除）
- 方案2：在Tab 5中手动删除不需要的文章
- 方案3：手动移动文章到其他目录

### Q7: 生成的文章质量不满意？
**A**: 
- 使用自定义主题，聚焦特定领域
- 在Tab 3选择更好的标题
- 可以手动编辑posts目录下的md文件
- 调整生成数量，重点关注质量

### Q8: 如何查看详细日志？
**A**: 
- 所有操作都会在终端输出详细日志
- 查看终端获取完整的错误信息
- 如果需要调试，可以修改代码添加更多日志

---

## 📊 系统状态说明

界面顶部的"系统状态"实时显示：

- **API Key**: ✅ 已设置 / ❌ 未设置
- **待发布文章**: X / 16 篇（当前数量/上限）
- **今日标题库**: X 个（今天生成的标题数量）

---

## 🎨 界面特点

- **响应式设计**：支持各种屏幕尺寸
- **实时进度**：所有操作都有进度提示
- **状态同步**：所有Tab共享系统状态
- **错误提示**：清晰的错误和成功消息
- **数据持久化**：所有数据自动保存

---

## 🚀 高级使用

### 自定义端口

编辑 `ui.py` 最后几行：

```python
app.launch(
    server_name="0.0.0.0",
    server_port=8888,  # 修改端口
    share=False,
    inbrowser=True
)
```

### 远程访问

```python
app.launch(
    server_name="0.0.0.0",
    server_port=7860,
    share=True,  # 生成公网访问链接
    inbrowser=True
)
```

### 身份验证

```python
app.launch(
    server_name="0.0.0.0",
    server_port=7860,
    auth=("username", "password"),  # 添加登录验证
    inbrowser=True
)
```

---

## 📝 总结

Web界面提供了更直观、更易用的操作方式：

✅ **优点**：
- 可视化操作，无需记忆命令
- 实时反馈，清晰的进度提示
- 一键流程，节省时间
- 文章预览和管理功能
- 适合非技术用户

💡 **建议**：
- 首次使用按照工作流1操作
- 熟悉后使用一键流程提高效率
- 结合命令行和界面，灵活使用

🎯 **最佳实践**：
- 早上使用一键流程生成内容
- 中午预览审核文章质量
- 下午批量发布到CSDN
- 保持稳定的更新节奏

---

**祝使用愉快！** 🎉

有问题请查看终端输出或提交Issue。
